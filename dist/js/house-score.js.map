{"version":3,"sources":["house-score/src/js/house-score.js"],"names":["savedResultField","event","ranges","document","querySelectorAll","scoreField","querySelector","radios","maxPriceField","getElementById","idealSpaceField","idealSpacePropertyField","priceField","spaceField","spacePropertyField","form","resultField","total","max","inverse","relativeScore","calcScore","relativeScoreSum","i","length","parseInt","getAttribute","getGrading","dataset","grading","value","getColorClass","result","thresholds","1","green","orange","2","3","setScore","range","score","closest","colorClass","innerHTML","setResult","remove","ceil","classList","add","onRangeInput","setMax","field","setAttribute","saveResult","parse","window","localStorage","name","scoreText","removeResult","newResults","results","JSON","filter","concat","push","onRemoveResult","renderResults","setItem","stringify","id","getItem","icon","entryField","appendChild","buttonField","addEventListener","createElement","preventDefault","stopPropagation"],"mappings":"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","file":"house-score.js","sourcesContent":["const ranges = document.querySelectorAll(\".form__range\");\r\nconst scoreField = document.querySelector(\".form__score-number\");\r\nconst radios = document.querySelectorAll(\".form__radio\");\r\nconst maxPriceField = document.getElementById(\"max-price\");\r\nconst idealSpaceField = document.getElementById(\"ideal-space-house\");\r\nconst idealSpacePropertyField = document.getElementById(\"ideal-space-property\");\r\nconst priceField = document.getElementById(\"price\");\r\nconst spaceField = document.getElementById(\"space-house\");\r\nconst spacePropertyField = document.getElementById(\"space-property\");\r\nconst form = document.querySelector(\".form\");\r\nconst savedResultField = document.querySelector(\".results\");\r\nconst savedResultNameField = document.querySelector(\".form__result-name\");\r\nlet resultField;\r\n\r\nconst calcScore = () => {\r\n  let relativeScoreSum = 0,\r\n    total = 0,\r\n    max,\r\n    value,\r\n    inverse,\r\n    relativeScore,\r\n    grading;\r\n  for (let i = 0; i < ranges.length; i++) {\r\n    max = parseInt(ranges[i].getAttribute(\"max\"), 10);\r\n    inverse = !!ranges[i].dataset.inverse;\r\n    grading = getGrading(ranges[i]);\r\n    value = parseInt(ranges[i].value, 10);\r\n    total += grading;\r\n    relativeScore = inverse ? 1 - value / max : value / max;\r\n    relativeScore *= grading;\r\n    relativeScoreSum += relativeScore;\r\n  }\r\n\r\n  return relativeScoreSum / total;\r\n};\r\nconst getColorClass = (value, max, inverse, grading) => {\r\n  const result = inverse ? 1 - value / max : value / max;\r\n  const thresholds = {\r\n    1: {\r\n      green: 1/2,\r\n      orange: 1/4\r\n    },\r\n    2: {\r\n      green: 2/3,\r\n      orange: 1/3\r\n    },\r\n    3: {\r\n      green: 3/4,\r\n      orange: 1/2\r\n    }\r\n  }\r\n\r\n\r\n  if (result > thresholds[grading].green) {\r\n    return \"form__result--green\";\r\n  }\r\n  if (result > thresholds[grading].orange) {\r\n    return \"form__result--orange\";\r\n  }\r\n  return \"form__result--red\";\r\n};\r\n\r\nconst getGrading = (range) => {\r\n  return parseInt(range\r\n    .closest(\".form__group\")\r\n    .querySelector(\".form__radio:checked\").value, 10);\r\n};\r\n\r\nconst setScore = () => {\r\n  const score = calcScore();\r\n  const colorClass = getColorClass(score, 1, false, 2);\r\n  scoreField.innerHTML = Math.ceil(calcScore() * 100) + \"/100\";\r\n  scoreField.classList.add(colorClass);\r\n};\r\nconst setResult = (range) => {\r\n  resultField = range.closest(\".form__group\").querySelector(\".form__result\");\r\n  resultField.innerHTML = range.value;\r\n\r\n  resultField.classList.remove(\"form__result--red\");\r\n  resultField.classList.remove(\"form__result--green\");\r\n  resultField.classList.remove(\"form__result--orange\");\r\n\r\n  const grading = getGrading(range);\r\n\r\n  const colorClass = getColorClass(\r\n    parseInt(range.value),\r\n    parseInt(range.getAttribute(\"max\")),\r\n    !!range.dataset.inverse,\r\n    grading\r\n  );\r\n\r\n  resultField.classList.add(colorClass);\r\n};\r\n\r\nconst onRangeInput = (range) => () => {\r\n  setResult(range);\r\n  setScore();\r\n};\r\n\r\nconst setMax = (field, value) => {\r\n  field.setAttribute(\"max\", value)\r\n};\r\n\r\nconst saveResult = () => {\r\n  if (!window.localStorage) {return;}\r\n  let results = JSON.parse(window.localStorage.getItem(\"house-score-results\") || \"[]\");\r\n  let name = savedResultNameField.value || `House-${results.length}`;\r\n  results.push({\r\n    name: name,\r\n    score: calcScore(),\r\n    scoreText: scoreField.innerHTML\r\n  });\r\n\r\n  window.localStorage.setItem(\"house-score-results\", JSON.stringify(results));\r\n}\r\n\r\nconst removeResult = (id) => {\r\n  if (!window.localStorage) {return;}\r\n  const results = JSON.parse(window.localStorage.getItem(\"house-score-results\") || \"[]\");\r\n  const newResults = results.filter(result => result.name !== id);\r\n  window.localStorage.setItem(\"house-score-results\", JSON.stringify(newResults));\r\n}\r\n\r\nconst onRemoveResult = function (name) {\r\n  return function () {\r\n    removeResult(name);\r\n    renderResults();\r\n  };\r\n};\r\n\r\nconst renderResults = () => {\r\n  if (!window.localStorage) {return;}\r\n  const results = JSON.parse(window.localStorage.getItem(\"house-score-results\") || \"[]\");\r\n  let colorClass;\r\n  savedResultField.innerHTML = \"\";\r\n\r\n  if (results.length <= 0) {\r\n    savedResultField.innerHTML = \"No saved scores.\";\r\n    return;\r\n  }\r\n\r\n  for (let i = 0; i < results.length; i++) {\r\n    let entryField = document.createElement(\"div\");\r\n    let buttonField = document.createElement(\"button\");\r\n    let icon = document.createElement(\"i\");\r\n    icon.classList.add(\"material-icons\");\r\n    icon.innerHTML = \"close\";\r\n    buttonField.classList.add(\"result__delete\");\r\n    buttonField.setAttribute(\"type\", \"button\");\r\n    buttonField.appendChild(icon);\r\n    entryField.classList.add(\"result__item\");\r\n    colorClass = getColorClass(results[i].score, 1, false, 2);\r\n    entryField.classList.add(colorClass);\r\n    entryField.innerHTML = results[i].name + \" - \" + results[i].scoreText;\r\n    entryField.appendChild(buttonField);\r\n    savedResultField.appendChild(entryField);\r\n\r\n    buttonField.addEventListener(\"click\", onRemoveResult(results[i].name));\r\n  }\r\n};\r\n\r\nfor (let i = 0; i < ranges.length; i++) {\r\n  ranges[i].addEventListener(\"input\", onRangeInput(ranges[i]));\r\n  ranges[i].addEventListener(\"change\", onRangeInput(ranges[i]));\r\n  setResult(ranges[i]);\r\n}\r\n\r\nlet range;\r\nfor (let i = 0; i < radios.length; i++) {\r\n  range = radios[i].closest(\".form__group\").querySelector(\".form__range\");\r\n  radios[i].addEventListener(\"input\", onRangeInput(range));\r\n  radios[i].addEventListener(\"change\", onRangeInput(range));\r\n}\r\n\r\nmaxPriceField.addEventListener(\"change\", () => {\r\n  setMax(priceField, maxPriceField.value);\r\n});\r\n\r\nidealSpaceField.addEventListener(\"change\", () => {\r\n  setMax(spaceField, idealSpaceField.value);\r\n});\r\n\r\nidealSpacePropertyField.addEventListener(\"change\", () => {\r\n  setMax(spacePropertyField, idealSpacePropertyField.value)\r\n});\r\n\r\nform.addEventListener(\"submit\", (event) => {\r\n  event.preventDefault();\r\n  event.stopPropagation();\r\n  saveResult();\r\n  renderResults();\r\n});\r\n\r\nsetScore();\r\nrenderResults();"]}