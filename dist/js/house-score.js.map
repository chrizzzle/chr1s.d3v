{"version":3,"sources":["house-score/src/js/house-score.js"],"names":["savedResultField","event","ranges","document","querySelectorAll","scoreField","querySelector","radios","maxPriceField","getElementById","idealSpaceField","idealSpacePropertyField","priceField","spaceField","spacePropertyField","form","resultField","total","max","inverse","relativeScore","calcScore","relativeScoreSum","i","length","parseInt","getAttribute","getGrading","dataset","grading","value","getColorClass","result","thresholds","1","green","orange","2","3","setScore","range","score","closest","colorClass","innerHTML","setResult","remove","ceil","classList","add","onRangeInput","setMax","field","setAttribute","saveResult","parse","window","localStorage","name","scoreText","removeResult","newResults","results","JSON","filter","concat","push","onRemoveResult","renderResults","setItem","stringify","id","getItem","icon","entryField","appendChild","buttonField","addEventListener","createElement","preventDefault","stopPropagation"],"mappings":"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","file":"house-score.js","sourcesContent":["const ranges = document.querySelectorAll(\".form__range\");\nconst scoreField = document.querySelector(\".form__score-number\");\nconst radios = document.querySelectorAll(\".form__radio\");\nconst maxPriceField = document.getElementById(\"max-price\");\nconst idealSpaceField = document.getElementById(\"ideal-space-house\");\nconst idealSpacePropertyField = document.getElementById(\"ideal-space-property\");\nconst priceField = document.getElementById(\"price\");\nconst spaceField = document.getElementById(\"space-house\");\nconst spacePropertyField = document.getElementById(\"space-property\");\nconst form = document.querySelector(\".form\");\nconst savedResultField = document.querySelector(\".results\");\nconst savedResultNameField = document.querySelector(\".form__result-name\");\nlet resultField;\n\nconst calcScore = () => {\n  let relativeScoreSum = 0,\n    total = 0,\n    max,\n    value,\n    inverse,\n    relativeScore,\n    grading;\n  for (let i = 0; i < ranges.length; i++) {\n    max = parseInt(ranges[i].getAttribute(\"max\"), 10);\n    inverse = !!ranges[i].dataset.inverse;\n    grading = getGrading(ranges[i]);\n    value = parseInt(ranges[i].value, 10);\n    total += grading;\n    relativeScore = inverse ? 1 - value / max : value / max;\n    relativeScore *= grading;\n    relativeScoreSum += relativeScore;\n  }\n\n  return relativeScoreSum / total;\n};\nconst getColorClass = (value, max, inverse, grading) => {\n  const result = inverse ? 1 - value / max : value / max;\n  const thresholds = {\n    1: {\n      green: 1/2,\n      orange: 1/4\n    },\n    2: {\n      green: 2/3,\n      orange: 1/3\n    },\n    3: {\n      green: 3/4,\n      orange: 1/2\n    }\n  }\n\n\n  if (result > thresholds[grading].green) {\n    return \"form__result--green\";\n  }\n  if (result > thresholds[grading].orange) {\n    return \"form__result--orange\";\n  }\n  return \"form__result--red\";\n};\n\nconst getGrading = (range) => {\n  return parseInt(range\n    .closest(\".form__group\")\n    .querySelector(\".form__radio:checked\").value, 10);\n};\n\nconst setScore = () => {\n  const score = calcScore();\n  const colorClass = getColorClass(score, 1, false, 2);\n  scoreField.innerHTML = Math.ceil(calcScore() * 100) + \"/100\";\n  scoreField.classList.add(colorClass);\n};\nconst setResult = (range) => {\n  resultField = range.closest(\".form__group\").querySelector(\".form__result\");\n  resultField.innerHTML = range.value;\n\n  resultField.classList.remove(\"form__result--red\");\n  resultField.classList.remove(\"form__result--green\");\n  resultField.classList.remove(\"form__result--orange\");\n\n  const grading = getGrading(range);\n\n  const colorClass = getColorClass(\n    parseInt(range.value),\n    parseInt(range.getAttribute(\"max\")),\n    !!range.dataset.inverse,\n    grading\n  );\n\n  resultField.classList.add(colorClass);\n};\n\nconst onRangeInput = (range) => () => {\n  setResult(range);\n  setScore();\n};\n\nconst setMax = (field, value) => {\n  field.setAttribute(\"max\", value)\n};\n\nconst saveResult = () => {\n  if (!window.localStorage) {return;}\n  let results = JSON.parse(window.localStorage.getItem(\"house-score-results\") || \"[]\");\n  let name = savedResultNameField.value || `House-${results.length}`;\n  results.push({\n    name: name,\n    score: calcScore(),\n    scoreText: scoreField.innerHTML\n  });\n\n  window.localStorage.setItem(\"house-score-results\", JSON.stringify(results));\n}\n\nconst removeResult = (id) => {\n  if (!window.localStorage) {return;}\n  const results = JSON.parse(window.localStorage.getItem(\"house-score-results\") || \"[]\");\n  const newResults = results.filter(result => result.name !== id);\n  window.localStorage.setItem(\"house-score-results\", JSON.stringify(newResults));\n}\n\nconst onRemoveResult = function (name) {\n  return function () {\n    removeResult(name);\n    renderResults();\n  };\n};\n\nconst renderResults = () => {\n  if (!window.localStorage) {return;}\n  const results = JSON.parse(window.localStorage.getItem(\"house-score-results\") || \"[]\");\n  let colorClass;\n  savedResultField.innerHTML = \"\";\n\n  if (results.length <= 0) {\n    savedResultField.innerHTML = \"No saved scores.\";\n    return;\n  }\n\n  for (let i = 0; i < results.length; i++) {\n    let entryField = document.createElement(\"div\");\n    let buttonField = document.createElement(\"button\");\n    let icon = document.createElement(\"i\");\n    icon.classList.add(\"material-icons\");\n    icon.innerHTML = \"close\";\n    buttonField.classList.add(\"result__delete\");\n    buttonField.setAttribute(\"type\", \"button\");\n    buttonField.appendChild(icon);\n    entryField.classList.add(\"result__item\");\n    colorClass = getColorClass(results[i].score, 1, false, 2);\n    entryField.classList.add(colorClass);\n    entryField.innerHTML = results[i].name + \" - \" + results[i].scoreText;\n    entryField.appendChild(buttonField);\n    savedResultField.appendChild(entryField);\n\n    buttonField.addEventListener(\"click\", onRemoveResult(results[i].name));\n  }\n};\n\nfor (let i = 0; i < ranges.length; i++) {\n  ranges[i].addEventListener(\"input\", onRangeInput(ranges[i]));\n  ranges[i].addEventListener(\"change\", onRangeInput(ranges[i]));\n  setResult(ranges[i]);\n}\n\nlet range;\nfor (let i = 0; i < radios.length; i++) {\n  range = radios[i].closest(\".form__group\").querySelector(\".form__range\");\n  radios[i].addEventListener(\"input\", onRangeInput(range));\n  radios[i].addEventListener(\"change\", onRangeInput(range));\n}\n\nmaxPriceField.addEventListener(\"change\", () => {\n  setMax(priceField, maxPriceField.value);\n});\n\nidealSpaceField.addEventListener(\"change\", () => {\n  setMax(spaceField, idealSpaceField.value);\n});\n\nidealSpacePropertyField.addEventListener(\"change\", () => {\n  setMax(spacePropertyField, idealSpacePropertyField.value)\n});\n\nform.addEventListener(\"submit\", (event) => {\n  event.preventDefault();\n  event.stopPropagation();\n  saveResult();\n  renderResults();\n});\n\nsetScore();\nrenderResults();"]}