{"version":3,"sources":["house-score/src/js/house-score.js"],"names":["entryField","savedResultField","range","ranges","document","querySelectorAll","scoreField","querySelector","radios","maxPriceField","getElementById","idealSpaceField","idealSpacePropertyField","priceField","spaceField","spacePropertyField","form","resultField","max","value","inverse","relativeScore","grading","relativeScoreSum","calcScore","length","i","getAttribute","dataset","getGrading","parseInt","total","getColorClass","result","thresholds","1","2","green","orange","3","closest","setScore","score","colorClass","innerHTML","classList","add","remove","setResult","onRangeInput","setMax","field","saveResult","window","localStorage","results","JSON","parse","getItem","name","savedResultNameField","push","scoreText","setItem","stringify","removeResult","newResults","filter","id","onRemoveResult","renderResults","createElement","icon","buttonField","setAttribute","appendChild","addEventListener","event","preventDefault","stopPropagation"],"mappings":"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","file":"house-score.js","sourcesContent":["const ranges = document.querySelectorAll(\".form__range\");\r\nconst scoreField = document.querySelector(\".form__score-number\");\r\nconst radios = document.querySelectorAll(\".form__radio\");\r\nconst maxPriceField = document.getElementById(\"max-price\");\r\nconst idealSpaceField = document.getElementById(\"ideal-space-house\");\r\nconst idealSpacePropertyField = document.getElementById(\"ideal-space-property\");\r\nconst priceField = document.getElementById(\"price\");\r\nconst spaceField = document.getElementById(\"space-house\");\r\nconst spacePropertyField = document.getElementById(\"space-property\");\r\nconst form = document.querySelector(\".form\");\r\nconst savedResultField = document.querySelector(\".results\");\r\nconst savedResultNameField = document.querySelector(\".form__result-name\");\r\nlet resultField;\r\n\r\nconst calcScore = () => {\r\n  let relativeScoreSum = 0,\r\n    total = 0,\r\n    max,\r\n    value,\r\n    inverse,\r\n    relativeScore,\r\n    grading;\r\n  for (let i = 0; i < ranges.length; i++) {\r\n    max = parseInt(ranges[i].getAttribute(\"max\"), 10);\r\n    inverse = !!ranges[i].dataset.inverse;\r\n    grading = getGrading(ranges[i]);\r\n    value = parseInt(ranges[i].value, 10);\r\n    total += grading;\r\n    relativeScore = inverse ? 1 - value / max : value / max;\r\n    relativeScore *= grading;\r\n    relativeScoreSum += relativeScore;\r\n  }\r\n\r\n  return relativeScoreSum / total;\r\n};\r\nconst getColorClass = (value, max, inverse, grading) => {\r\n  const result = inverse ? 1 - value / max : value / max;\r\n  const thresholds = {\r\n    1: {\r\n      green: 1/2,\r\n      orange: 1/4\r\n    },\r\n    2: {\r\n      green: 2/3,\r\n      orange: 1/3\r\n    },\r\n    3: {\r\n      green: 3/4,\r\n      orange: 1/2\r\n    }\r\n  }\r\n\r\n\r\n  if (result > thresholds[grading].green) {\r\n    return \"form__result--green\";\r\n  }\r\n  if (result > thresholds[grading].orange) {\r\n    return \"form__result--orange\";\r\n  }\r\n  return \"form__result--red\";\r\n};\r\n\r\nconst getGrading = (range) => {\r\n  return parseInt(range\r\n    .closest(\".form__group\")\r\n    .querySelector(\".form__radio:checked\").value, 10);\r\n};\r\n\r\nconst setScore = () => {\r\n  const score = calcScore();\r\n  const colorClass = getColorClass(score, 1, false, 2);\r\n  scoreField.innerHTML = Math.ceil(calcScore() * 100) + \"/100\";\r\n  scoreField.classList.add(colorClass);\r\n};\r\nconst setResult = (range) => {\r\n  resultField = range.closest(\".form__group\").querySelector(\".form__result\");\r\n  resultField.innerHTML = range.value;\r\n\r\n  resultField.classList.remove(\"form__result--red\");\r\n  resultField.classList.remove(\"form__result--green\");\r\n  resultField.classList.remove(\"form__result--orange\");\r\n\r\n  const grading = getGrading(range);\r\n\r\n  const colorClass = getColorClass(\r\n    parseInt(range.value),\r\n    parseInt(range.getAttribute(\"max\")),\r\n    !!range.dataset.inverse,\r\n    grading\r\n  );\r\n\r\n  resultField.classList.add(colorClass);\r\n};\r\n\r\nconst onRangeInput = (range) => () => {\r\n  setResult(range);\r\n  setScore();\r\n};\r\n\r\nconst setMax = (field, value) => {\r\n  field.setAttribute(\"max\", value)\r\n};\r\n\r\nconst saveResult = () => {\r\n  if (!window.localStorage) {return;}\r\n  let results = JSON.parse(window.localStorage.getItem(\"house-score-results\") || \"[]\");\r\n  let name = savedResultNameField.value || `House-${results.length}`;\r\n  results.push({\r\n    name: name,\r\n    score: calcScore(),\r\n    scoreText: scoreField.innerHTML\r\n  });\r\n\r\n  window.localStorage.setItem(\"house-score-results\", JSON.stringify(results));\r\n}\r\n\r\nconst removeResult = (id) => {\r\n  if (!window.localStorage) {return;}\r\n  const results = JSON.parse(window.localStorage.getItem(\"house-score-results\") || \"[]\");\r\n  const newResults = results.filter(result => result.name !== id);\r\n  window.localStorage.setItem(\"house-score-results\", JSON.stringify(newResults));\r\n}\r\n\r\nconst onRemoveResult = function (name) {\r\n  return function () {\r\n    removeResult(name);\r\n    renderResults();\r\n  };\r\n};\r\n\r\nconst renderResults = () => {\r\n  if (!window.localStorage) {return;}\r\n  const results = JSON.parse(window.localStorage.getItem(\"house-score-results\") || \"[]\");\r\n  let colorClass;\r\n  savedResultField.innerHTML = \"\";\r\n\r\n  if (results.length <= 0) {\r\n    savedResultField.innerHTML = \"No saved scores.\";\r\n    return;\r\n  }\r\n\r\n  for (let i = 0; i < results.length; i++) {\r\n    let entryField = document.createElement(\"div\");\r\n    let buttonField = document.createElement(\"button\");\r\n    let icon = document.createElement(\"i\");\r\n    icon.classList.add(\"material-icons\");\r\n    icon.innerHTML = \"close\";\r\n    buttonField.classList.add(\"result__delete\");\r\n    buttonField.setAttribute(\"type\", \"button\");\r\n    buttonField.appendChild(icon);\r\n    entryField.classList.add(\"result__item\");\r\n    colorClass = getColorClass(results[i].score, 1, false, 2);\r\n    entryField.classList.add(colorClass);\r\n    entryField.innerHTML = results[i].name + \" - \" + results[i].scoreText;\r\n    entryField.appendChild(buttonField);\r\n    savedResultField.appendChild(entryField);\r\n\r\n    buttonField.addEventListener(\"click\", onRemoveResult(results[i].name));\r\n  }\r\n};\r\n\r\nfor (let i = 0; i < ranges.length; i++) {\r\n  ranges[i].addEventListener(\"input\", onRangeInput(ranges[i]));\r\n  ranges[i].addEventListener(\"change\", onRangeInput(ranges[i]));\r\n  setResult(ranges[i]);\r\n}\r\n\r\nlet range;\r\nfor (let i = 0; i < radios.length; i++) {\r\n  range = radios[i].closest(\".form__group\").querySelector(\".form__range\");\r\n  radios[i].addEventListener(\"input\", onRangeInput(range));\r\n  radios[i].addEventListener(\"change\", onRangeInput(range));\r\n}\r\n\r\nmaxPriceField.addEventListener(\"change\", () => {\r\n  setMax(priceField, maxPriceField.value);\r\n});\r\n\r\nidealSpaceField.addEventListener(\"change\", () => {\r\n  setMax(spaceField, idealSpaceField.value);\r\n});\r\n\r\nidealSpacePropertyField.addEventListener(\"change\", () => {\r\n  setMax(spacePropertyField, idealSpacePropertyField.value)\r\n});\r\n\r\nform.addEventListener(\"submit\", (event) => {\r\n  event.preventDefault();\r\n  event.stopPropagation();\r\n  saveResult();\r\n  renderResults();\r\n});\r\n\r\nsetScore();\r\nrenderResults();"]}