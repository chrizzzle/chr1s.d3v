"use strict";for(var resultField,totalMax,ranges=document.querySelectorAll(".form__range"),scoreField=document.querySelector(".form__score-number"),radios=document.querySelectorAll(".form__radio"),maxPriceField=document.getElementById("max-price"),idealSpaceField=document.getElementById("ideal-space-house"),idealSpacePropertyField=document.getElementById("ideal-space-property"),priceField=document.getElementById("price"),spaceField=document.getElementById("space-house"),spacePropertyField=document.getElementById("space-property"),form=document.querySelector(".form"),savedResultField=document.querySelector(".results"),savedResultNameField=document.querySelector(".form__result-name"),calcScore=function(){for(var e,t,r,s,a,n=0,l=0,o=0;o<ranges.length;o++)e=parseInt(ranges[o].getAttribute("max"),10),r=!!ranges[o].dataset.inverse,a=getGrading(ranges[o]),t=parseInt(ranges[o].value,10),l+=a,s=r?1-t/e:t/e,n+=s*=a;return n/l},getColorClass=function(e,t,r,s){var a=r?1-e/t:e/t,n={1:{green:.5,orange:.25},2:{green:2/3,orange:1/3},3:{green:.75,orange:.5}};return a>n[s].green?"form__result--green":a>n[s].orange?"form__result--orange":"form__result--red"},getGrading=function(e){return parseInt(e.closest(".form__group").querySelector(".form__radio:checked").value,10)},setScore=function(){var e=calcScore(),t=getColorClass(e,1,!1,2);scoreField.innerHTML=Math.ceil(100*calcScore())+"/100",scoreField.classList.add(t)},setResult=function(e){(resultField=e.closest(".form__group").querySelector(".form__result")).innerHTML=e.value,resultField.classList.remove("form__result--red"),resultField.classList.remove("form__result--green"),resultField.classList.remove("form__result--orange");var t=getGrading(e),r=getColorClass(parseInt(e.value),parseInt(e.getAttribute("max")),!!e.dataset.inverse,t);resultField.classList.add(r)},onRangeInput=function(e){return function(){setResult(e),setScore()}},setMax=function(e,t){e.setAttribute("max",t)},saveResult=function(){var e=JSON.parse(localStorage.getItem("house-score-results")||"[]"),t=savedResultNameField.value||"House-".concat(e.length);e.push({name:t,score:calcScore(),scoreText:scoreField.innerHTML}),localStorage.setItem("house-score-results",JSON.stringify(e))},removeResult=function(t){var e=JSON.parse(localStorage.getItem("house-score-results")||"[]").filter(function(e){return e.name!==t});localStorage.setItem("house-score-results",JSON.stringify(e))},onRemoveResult=function(e){return function(){removeResult(e),renderResults()}},renderResults=function(){var e,t=JSON.parse(localStorage.getItem("house-score-results")||"[]");if(savedResultField.innerHTML="",t.length<=0)savedResultField.innerHTML="No saved scores.";else for(var r=0;r<t.length;r++){var s=document.createElement("div"),a=document.createElement("button"),n=document.createElement("i");n.classList.add("material-icons"),n.innerHTML="close",a.classList.add("result__delete"),a.setAttribute("type","button"),a.appendChild(n),s.classList.add("result__item"),e=getColorClass(t[r].score,1,!1,2),s.classList.add(e),s.innerHTML=t[r].name+" - "+t[r].scoreText,s.appendChild(a),savedResultField.appendChild(s),a.addEventListener("click",onRemoveResult(t[r].name))}},i=0;i<ranges.length;i++)ranges[i].addEventListener("input",onRangeInput(ranges[i])),setResult(ranges[i]),totalMax+=parseInt(ranges[i].getAttribute("max"),10);for(var _i=0;_i<radios.length;_i++){var range=void 0;range=radios[_i].closest(".form__group").querySelector(".form__range"),radios[_i].addEventListener("input",onRangeInput(range))}maxPriceField.addEventListener("change",function(){setMax(priceField,maxPriceField.value)}),idealSpaceField.addEventListener("change",function(){setMax(spaceField,idealSpaceField.value)}),idealSpacePropertyField.addEventListener("change",function(){setMax(spacePropertyField,idealSpacePropertyField.value)}),form.addEventListener("submit",function(e){e.preventDefault(),e.stopPropagation(),saveResult(),renderResults()}),setScore(),renderResults();