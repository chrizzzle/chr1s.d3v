"use strict";for(var resultField,range,ranges=document.querySelectorAll(".form__range"),scoreField=document.querySelector(".form__score-number"),radios=document.querySelectorAll(".form__radio"),maxPriceField=document.getElementById("max-price"),idealSpaceField=document.getElementById("ideal-space-house"),idealSpacePropertyField=document.getElementById("ideal-space-property"),priceField=document.getElementById("price"),spaceField=document.getElementById("space-house"),spacePropertyField=document.getElementById("space-property"),form=document.querySelector(".form"),savedResultField=document.querySelector(".results"),savedResultNameField=document.querySelector(".form__result-name"),calcScore=function(){for(var e,r,t,n,s,a=0,o=0,l=0;l<ranges.length;l++)e=parseInt(ranges[l].getAttribute("max"),10),t=!!ranges[l].dataset.inverse,s=getGrading(ranges[l]),r=parseInt(ranges[l].value,10),o+=s,n=t?1-r/e:r/e,a+=n*=s;return a/o},getColorClass=function(e,r,t,n){var s=t?1-e/r:e/r,a={1:{green:.5,orange:.25},2:{green:2/3,orange:1/3},3:{green:.75,orange:.5}};return s>a[n].green?"form__result--green":s>a[n].orange?"form__result--orange":"form__result--red"},getGrading=function(e){return parseInt(e.closest(".form__group").querySelector(".form__radio:checked").value,10)},setScore=function(){var e=calcScore(),r=getColorClass(e,1,!1,2);scoreField.innerHTML=Math.ceil(100*calcScore())+"/100",scoreField.classList.add(r)},setResult=function(e){(resultField=e.closest(".form__group").querySelector(".form__result")).innerHTML=e.value,resultField.classList.remove("form__result--red"),resultField.classList.remove("form__result--green"),resultField.classList.remove("form__result--orange");var r=getGrading(e),t=getColorClass(parseInt(e.value),parseInt(e.getAttribute("max")),!!e.dataset.inverse,r);resultField.classList.add(t)},onRangeInput=function(e){return function(){setResult(e),setScore()}},setMax=function(e,r){e.setAttribute("max",r)},saveResult=function(){if(window.localStorage){var e=JSON.parse(window.localStorage.getItem("house-score-results")||"[]"),r=savedResultNameField.value||"House-".concat(e.length);e.push({name:r,score:calcScore(),scoreText:scoreField.innerHTML}),window.localStorage.setItem("house-score-results",JSON.stringify(e))}},removeResult=function(r){if(window.localStorage){var e=JSON.parse(window.localStorage.getItem("house-score-results")||"[]").filter(function(e){return e.name!==r});window.localStorage.setItem("house-score-results",JSON.stringify(e))}},onRemoveResult=function(e){return function(){removeResult(e),renderResults()}},renderResults=function(){if(window.localStorage){var e,r=JSON.parse(window.localStorage.getItem("house-score-results")||"[]");if(savedResultField.innerHTML="",r.length<=0)savedResultField.innerHTML="No saved scores.";else for(var t=0;t<r.length;t++){var n=document.createElement("div"),s=document.createElement("button"),a=document.createElement("i");a.classList.add("material-icons"),a.innerHTML="close",s.classList.add("result__delete"),s.setAttribute("type","button"),s.appendChild(a),n.classList.add("result__item"),e=getColorClass(r[t].score,1,!1,2),n.classList.add(e),n.innerHTML=r[t].name+" - "+r[t].scoreText,n.appendChild(s),savedResultField.appendChild(n),s.addEventListener("click",onRemoveResult(r[t].name))}}},i=0;i<ranges.length;i++)ranges[i].addEventListener("input",onRangeInput(ranges[i])),ranges[i].addEventListener("change",onRangeInput(ranges[i])),setResult(ranges[i]);for(var _i=0;_i<radios.length;_i++)range=radios[_i].closest(".form__group").querySelector(".form__range"),radios[_i].addEventListener("input",onRangeInput(range)),radios[_i].addEventListener("change",onRangeInput(range));maxPriceField.addEventListener("change",function(){setMax(priceField,maxPriceField.value)}),idealSpaceField.addEventListener("change",function(){setMax(spaceField,idealSpaceField.value)}),idealSpacePropertyField.addEventListener("change",function(){setMax(spacePropertyField,idealSpacePropertyField.value)}),form.addEventListener("submit",function(e){e.preventDefault(),e.stopPropagation(),saveResult(),renderResults()}),setScore(),renderResults();
//# sourceMappingURL=house-score.js.map
